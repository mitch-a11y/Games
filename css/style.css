/* ============================================
   HANSE: Merchants of the Baltic
   Phase 2 — Complete UI/UX Overhaul
   ============================================ */

/* --- Reset & Base --- */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
    --bg-dark: #0c111c;
    --bg-medium: #131b2e;
    --bg-light: #1a2744;
    --bg-panel: rgba(16, 24, 42, 0.92);
    --bg-panel-solid: #10182a;
    --bg-panel-light: rgba(26, 39, 68, 0.85);
    --bg-card: rgba(20, 32, 56, 0.7);
    --bg-card-hover: rgba(26, 42, 72, 0.85);
    --accent: #e6a817;
    --accent-light: #f0c850;
    --accent-dark: #b8860b;
    --accent-glow: rgba(230, 168, 23, 0.25);
    --text: #d4cbb8;
    --text-light: #f0ebe0;
    --text-dim: #6a7a90;
    --sea: #0e1e38;
    --danger: #d94040;
    --success: #2eac68;
    --warning: #e8a020;
    --info: #3498db;
    --gold-color: #ffd700;
    --border: rgba(60, 90, 140, 0.3);
    --border-bright: rgba(100, 140, 200, 0.3);
    --glass-bg: rgba(16, 24, 42, 0.85);
    --glass-border: rgba(80, 120, 180, 0.2);
    --scrollbar-bg: rgba(20, 36, 64, 0.5);
    --scrollbar-thumb: rgba(60, 90, 140, 0.5);
    --font-main: 'Segoe UI', system-ui, -apple-system, sans-serif;
    --font-title: Georgia, 'Palatino Linotype', 'Book Antiqua', serif;
    --radius: 8px;
    --radius-sm: 4px;
    --radius-lg: 12px;
    --shadow-sm: 0 2px 8px rgba(0,0,0,0.3);
    --shadow-md: 0 4px 20px rgba(0,0,0,0.4);
    --shadow-lg: 0 8px 40px rgba(0,0,0,0.5);
    --transition: 0.2s ease;
    /* Parchment theme colors */
    --parchment-bg: #e8d5b0;
    --parchment-dark: #c4a87a;
    --parchment-text: #3b2a1a;
    --parchment-header: #5a3e28;
    --parchment-border: rgba(120, 85, 40, 0.5);
    --parchment-card: rgba(180, 155, 110, 0.35);
    --parchment-card-hover: rgba(170, 140, 90, 0.5);
}

html, body {
    width: 100%; height: 100%;
    overflow: hidden;
    font-family: var(--font-main);
    font-size: 14px;
    color: var(--text);
    background: var(--bg-dark);
    -webkit-font-smoothing: antialiased;
}

/* Scrollbar */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: var(--scrollbar-bg); }
::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(80, 110, 160, 0.6); }

.hidden { display: none !important; }

/* === SCREENS === */
.screen {
    display: none; width: 100%; height: 100%;
    position: absolute; top: 0; left: 0;
    opacity: 0; transition: opacity 0.5s ease;
}
.screen.active { display: flex; opacity: 1; }

/* === TITLE SCREEN (Canvas map background) === */
#title-screen {
    background: #1a1510;
    justify-content: center; align-items: center;
    flex-direction: column;
    overflow: hidden;
    position: relative;
}

#intro-canvas {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 1;
}

.title-overlay {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 2;
    display: flex; justify-content: flex-start; align-items: center;
    pointer-events: none;
}

.title-overlay .title-content {
    pointer-events: auto;
    text-align: left;
    padding-left: clamp(30px, 5vw, 80px);
    max-width: min(440px, 40vw);
    transition: opacity 0.5s ease;
}

/* Leonardo mode: JS sets position/size dynamically to match the painted image */
.title-overlay .title-content.leonardo-mode {
    position: absolute;
    padding-left: 0;
    max-width: none;
}

/* Setup screen with canvas bg */
#setup-screen { position: relative; }
#setup-bg-canvas {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 0;
}
.setup-overlay {
    position: relative; z-index: 1;
    width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
}

.title-container {
    text-align: center;
    display: flex; align-items: center; gap: 40px;
    position: relative; z-index: 2;
}

@keyframes titleFadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Title — warm gold on parchment */
.game-title {
    font-family: var(--font-title);
    font-size: clamp(48px, 7vw, 90px);
    color: #d4a030;
    text-shadow:
        0 0 40px rgba(200, 150, 40, 0.35),
        0 0 100px rgba(200, 150, 40, 0.12),
        0 2px 6px rgba(0, 0, 0, 0.9),
        2px 4px 8px rgba(0, 0, 0, 0.5);
    letter-spacing: clamp(10px, 2.5vw, 24px);
    margin-bottom: 6px;
    font-weight: normal;
}

.game-subtitle {
    font-family: var(--font-title);
    font-size: clamp(13px, 1.4vw, 18px);
    color: rgba(190, 170, 130, 0.65);
    font-weight: normal;
    letter-spacing: clamp(3px, 0.6vw, 8px);
    text-transform: uppercase;
    margin-bottom: 8px;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8);
}

/* Ornament line — warm gold gradient */
.title-ornament {
    width: 220px; height: 1px;
    background: linear-gradient(90deg,
        rgba(180, 140, 50, 0.6),
        rgba(180, 140, 50, 0.15),
        transparent
    );
    margin: 24px 0 40px;
    position: relative;
}
.title-ornament::before {
    content: '';
    position: absolute; top: -1px; left: 0; width: 6px; height: 3px;
    background: rgba(200, 160, 60, 0.6);
    border-radius: 1px;
}
.title-ornament::after {
    content: '\2756'; /* four diamond */
    position: absolute; top: -9px; left: 30px;
    color: rgba(180, 140, 50, 0.45);
    font-size: 14px;
}

/* Menu buttons — parchment/leather style */
.title-menu {
    display: flex; flex-direction: column;
    gap: 8px; align-items: flex-start;
}

.title-btn {
    width: 260px; padding: 14px 24px 14px 20px;
    font-family: var(--font-title); font-size: 16px;
    color: #c8b890;
    letter-spacing: 2px;
    background: linear-gradient(135deg,
        rgba(50, 38, 22, 0.85),
        rgba(40, 30, 18, 0.9)
    );
    border: 1px solid rgba(140, 110, 50, 0.2);
    border-left: 3px solid rgba(180, 140, 50, 0.45);
    border-radius: 0 6px 6px 0;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    text-align: left;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
}

/* Parchment texture shimmer on hover */
.title-btn::before {
    content: '';
    position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
    background: linear-gradient(90deg,
        transparent,
        rgba(200, 160, 60, 0.1),
        transparent
    );
    transition: left 0.5s ease;
}
.title-btn:hover::before { left: 100%; }

.title-btn:hover {
    background: linear-gradient(135deg,
        rgba(70, 52, 28, 0.9),
        rgba(55, 42, 22, 0.95)
    );
    border-color: rgba(200, 160, 60, 0.45);
    border-left-color: rgba(220, 175, 60, 0.7);
    color: #e8d4a0;
    transform: translateX(4px);
    box-shadow:
        0 2px 15px rgba(180, 140, 40, 0.12),
        inset 0 1px 0 rgba(200, 160, 60, 0.1);
}

.title-btn:active {
    transform: translateX(2px);
    background: linear-gradient(135deg,
        rgba(60, 45, 24, 0.95),
        rgba(45, 34, 18, 0.98)
    );
}

/* Button icon accent */
.title-btn .btn-icon {
    margin-right: 10px;
    font-size: 18px;
    opacity: 0.7;
}

/* Credit line — warm parchment tone */
.title-credit {
    margin-top: 36px; font-size: 10px;
    color: rgba(160, 140, 100, 0.3);
    font-style: italic; letter-spacing: 1px;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* Version tag */
.title-version {
    position: absolute;
    bottom: 12px; right: 16px;
    font-size: 10px;
    color: rgba(140, 120, 80, 0.2);
    z-index: 3;
    font-style: italic;
}

/* === LEONARDO MODE — hide HTML text, use image artwork === */
.title-content.leonardo-mode .game-title,
.title-content.leonardo-mode .game-subtitle,
.title-content.leonardo-mode .title-ornament {
    display: none !important;
}

.title-content.leonardo-mode .title-menu {
    margin-top: 0;
    gap: 4px;
}

.title-content.leonardo-mode .title-btn {
    border: none;
    border-left: none;
    color: transparent;
    text-shadow: none;
    box-shadow: none;
    cursor: pointer;
    transition: filter 0.2s ease, transform 0.15s ease;
    border-radius: 6px;
    z-index: 100;
    background-size: 100% 100%;
    background-repeat: no-repeat;
}

.title-content.leonardo-mode .title-btn .btn-icon {
    display: none;
}

.title-content.leonardo-mode .title-btn::before {
    display: none;
}

.title-content.leonardo-mode .title-btn:hover {
    color: transparent;
    transform: scale(1.05);
    filter: brightness(1.25);
    box-shadow: 0 4px 20px rgba(200, 160, 60, 0.4);
}

.title-content.leonardo-mode .title-btn:active {
    transform: scale(0.97);
    filter: brightness(0.9);
}

.title-content.leonardo-mode .title-credit {
    color: rgba(160, 140, 100, 0.2);
}

/* === SETUP SCREEN — warm parchment/map style === */
#setup-screen {
    background: #1a1510;
    justify-content: center; align-items: center;
}

.setup-container {
    background: linear-gradient(145deg,
        rgba(40, 32, 18, 0.95),
        rgba(32, 24, 14, 0.97)
    );
    border: 1px solid rgba(140, 110, 50, 0.2);
    border-radius: var(--radius-lg);
    padding: 36px 48px;
    min-width: 420px;
    max-width: 90vw;
    backdrop-filter: blur(12px);
    box-shadow:
        0 8px 40px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(180, 150, 60, 0.06);
    animation: modalIn 0.4s ease-out;
    position: relative;
}
/* Subtle parchment texture */
.setup-container::before {
    content: '';
    position: absolute; inset: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><filter id="n"><feTurbulence baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/></filter><rect width="200" height="200" filter="url(%23n)" opacity="0.04"/></svg>');
    border-radius: inherit;
    pointer-events: none;
    opacity: 0.5;
}
@keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.setup-container h2 {
    font-family: var(--font-title); color: #d4a030;
    margin-bottom: 28px; text-align: center;
    font-size: 24px; font-weight: normal;
    letter-spacing: 2px;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 0.6);
}

.form-group { margin-bottom: 18px; }
.form-group label {
    display: block; margin-bottom: 6px;
    color: rgba(180, 160, 120, 0.6); font-size: 12px;
    text-transform: uppercase; letter-spacing: 1px;
}
.form-group input, .form-group select {
    width: 100%; padding: 10px 14px;
    background: rgba(18, 14, 8, 0.7);
    color: #d4cbb8;
    border: 1px solid rgba(120, 95, 40, 0.25);
    border-radius: var(--radius-sm);
    font-size: 15px; font-family: var(--font-main);
    transition: border-color var(--transition);
}
.form-group input:focus, .form-group select:focus {
    outline: none;
    border-color: rgba(200, 160, 60, 0.5);
    box-shadow: 0 0 0 3px rgba(200, 160, 60, 0.12);
}
.form-group select { cursor: pointer; }
.form-group select option { background: #1a1510; color: #d4cbb8; }

.setup-buttons { display: flex; gap: 12px; margin-top: 28px; }

.btn-primary, .btn-secondary {
    flex: 1; padding: 12px 24px;
    font-size: 15px; font-weight: 600;
    border-radius: var(--radius);
    cursor: pointer; transition: all 0.25s ease;
    font-family: var(--font-main);
    border: 1px solid; letter-spacing: 0.5px;
}
.btn-primary {
    background: linear-gradient(135deg, #8a6a1a, #b8860b, #d4a030);
    color: #fff; border-color: rgba(200, 160, 60, 0.6);
    box-shadow: 0 2px 12px rgba(180, 140, 40, 0.2);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
}
.btn-primary:hover {
    background: linear-gradient(135deg, #a07820, #d4a030, #e8b840);
    box-shadow: 0 4px 20px rgba(200, 160, 50, 0.3);
    transform: translateY(-1px);
}
.btn-secondary {
    background: rgba(40, 32, 18, 0.6);
    color: #b0a080; border-color: rgba(120, 95, 40, 0.25);
}
.btn-secondary:hover {
    background: rgba(55, 44, 24, 0.8);
    border-color: rgba(160, 130, 55, 0.35);
    color: #d4cbb8;
}

/* === HELP SCREEN — warm parchment style === */
#help-screen {
    background: #1a1510;
    justify-content: center; align-items: center;
}
.help-container {
    background: linear-gradient(145deg,
        rgba(40, 32, 18, 0.95),
        rgba(32, 24, 14, 0.97)
    );
    border: 1px solid rgba(140, 110, 50, 0.2);
    border-radius: var(--radius-lg);
    padding: 32px; max-width: 700px; max-height: 80vh;
    overflow-y: auto; backdrop-filter: blur(12px);
    box-shadow:
        0 8px 40px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(180, 150, 60, 0.06);
    animation: modalIn 0.4s ease-out;
}
.help-container h2 {
    font-family: var(--font-title); color: #d4a030;
    margin-bottom: 20px; text-align: center;
    font-weight: normal; letter-spacing: 2px;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 0.6);
}
.help-content h3 {
    color: #c8a040; margin: 20px 0 8px;
    font-size: 16px; font-family: var(--font-title);
}
.help-content p { margin-bottom: 10px; line-height: 1.6; color: #c4b898; opacity: 0.9; }
.help-content ul { margin: 8px 0 16px 20px; }
.help-content li { margin-bottom: 6px; line-height: 1.5; color: #b0a080; opacity: 0.85; }
.help-content li strong { color: #d4a030; }
.help-container .btn-primary {
    margin-top: 24px; display: block;
    width: 180px; margin-left: auto; margin-right: auto;
}

/* === GAME SCREEN === */
#game-screen {
    flex-direction: column;
    background: var(--bg-dark);
}

/* --- Top Bar --- */
#top-bar {
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 16px; height: 44px; flex-shrink: 0;
    background: linear-gradient(180deg, rgba(16, 24, 42, 0.98), rgba(12, 18, 32, 0.95));
    border-bottom: 1px solid var(--border);
    z-index: 10;
    backdrop-filter: blur(8px);
}
.top-bar-left, .top-bar-center, .top-bar-right {
    display: flex; align-items: center; gap: 14px;
}
.top-info {
    font-size: 13px; white-space: nowrap;
    color: var(--text-dim);
}
.top-info.gold {
    color: var(--gold-color);
    font-weight: 600;
    text-shadow: 0 0 8px rgba(255, 215, 0, 0.2);
}

.speed-controls { display: flex; gap: 2px; }
.speed-btn {
    padding: 4px 10px; font-size: 11px;
    background: transparent;
    color: var(--text-dim);
    border: 1px solid transparent;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition);
}
.speed-btn:hover {
    color: var(--text);
    background: rgba(40, 60, 100, 0.3);
}
.speed-btn.active {
    background: rgba(230, 168, 23, 0.15);
    color: var(--accent);
    border-color: rgba(230, 168, 23, 0.3);
}

.top-btn {
    padding: 4px 8px; font-size: 16px;
    background: none; color: var(--text-dim);
    border: none; border-radius: var(--radius-sm);
    cursor: pointer; transition: all var(--transition);
}
.top-btn:hover { color: var(--accent); background: rgba(40, 60, 100, 0.3); }

/* --- Main Content --- */
#main-content { display: flex; flex: 1; overflow: hidden; }

/* --- Map Panel --- */
#map-panel {
    flex: 1; position: relative; overflow: hidden;
    background: var(--sea);
}
#game-map { width: 100%; height: 100%; display: block; cursor: crosshair; }

#wind-indicator {
    position: absolute; bottom: 12px; left: 12px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    padding: 6px 10px;
    display: flex; align-items: center; gap: 6px;
    font-size: 12px;
    backdrop-filter: blur(8px);
}
#wind-direction { font-size: 20px; }
#wind-label { color: var(--text-dim); font-size: 11px; }

/* --- Tooltip --- */
.tooltip {
    position: absolute; padding: 10px 14px;
    background: var(--glass-bg);
    border: 1px solid rgba(230, 168, 23, 0.25);
    border-radius: var(--radius);
    font-size: 12px; pointer-events: none;
    z-index: 100; max-width: 240px;
    box-shadow: var(--shadow-md);
    backdrop-filter: blur(12px);
}
.tooltip.hidden { display: none; }
.tooltip h4 { color: var(--accent); margin-bottom: 6px; font-size: 14px; }
.tooltip p { color: var(--text); margin: 3px 0; font-size: 11px; line-height: 1.4; }

/* === SIDE PANEL === */
#side-panel {
    /* Scoped parchment theme — overrides global dark vars within side-panel */
    --text: #3b2a1a;
    --text-light: #2a1c0e;
    --text-dim: #6b5a48;
    --danger: #8b2020;
    --success: #2a7a48;
    --warning: #a87010;
    --info: #2a6a9a;
    --gold-color: #8b6914;
    --border: rgba(120, 90, 50, 0.4);
    --border-bright: rgba(160, 120, 60, 0.3);
    --glass-bg: rgba(210, 190, 155, 0.75);
    --glass-border: rgba(160, 130, 80, 0.3);
    --scrollbar-bg: rgba(200, 180, 140, 0.2);
    --scrollbar-thumb: rgba(140, 110, 60, 0.5);
    --bg-card: var(--parchment-card);
    --bg-card-hover: var(--parchment-card-hover);

    width: 380px; flex-shrink: 0;
    background: linear-gradient(180deg, #d8c49a 0%, #cdb88a 50%, #c4ad7e 100%);
    border-left: 3px solid #8b6b3a;
    display: flex; flex-direction: column;
    overflow: hidden;
    box-shadow: -4px 0 20px rgba(0,0,0,0.5), inset 0 0 30px rgba(120, 85, 40, 0.15);
    position: relative;
    color: #3b2a1a;
}


/* Side panel city banner */
#side-panel-city-banner {
    flex-shrink: 0;
    padding: 10px 16px;
    background: linear-gradient(135deg, rgba(90, 62, 40, 0.25), rgba(140, 107, 58, 0.15));
    border-bottom: 2px solid var(--parchment-border);
    display: flex; justify-content: space-between; align-items: center;
    font-size: 13px; min-height: 44px;
    position: relative;
}
#side-panel-city-banner::after {
    content: '';
    position: absolute; bottom: -1px; left: 5%; right: 5%;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(120, 85, 40, 0.4), transparent);
}
#side-panel-city-name {
    color: var(--parchment-header); font-family: var(--font-title);
    font-size: 18px; font-weight: bold;
    letter-spacing: 1.5px;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.6);
}
#side-panel-city-gold {
    color: var(--gold-color); font-weight: 700; font-size: 12px;
    letter-spacing: 0.5px;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.5);
}

#side-panel-tabs {
    display: flex;
    border-bottom: 2px solid var(--parchment-border);
    flex-shrink: 0;
    padding: 0;
    gap: 0;
    background: linear-gradient(180deg, rgba(90, 62, 40, 0.3), rgba(90, 62, 40, 0.15));
}
.tab-btn {
    flex: 1; padding: 10px 4px 8px;
    font-size: 12px; font-weight: 700;
    background: transparent;
    color: var(--parchment-header);
    border: none;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    transition: all var(--transition);
    text-transform: uppercase;
    letter-spacing: 1px;
    position: relative;
    font-family: var(--font-title);
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.5);
}
.tab-btn:hover {
    color: #2a1c0e;
    background: rgba(120, 85, 40, 0.12);
}
.tab-btn.active {
    color: #8b6914;
    border-bottom-color: #8b6914;
    background: rgba(140, 107, 58, 0.15);
}
.tab-btn.active::after {
    content: '';
    position: absolute; bottom: -2px; left: 15%; right: 15%;
    height: 3px;
    background: linear-gradient(90deg, transparent, #8b6914, transparent);
}

.tab-content {
    display: none; flex: 1;
    overflow-y: auto; padding: 14px;
    color: var(--parchment-text);
}
.tab-content.active { display: block; }
.tab-content::-webkit-scrollbar { width: 6px; }
.tab-content::-webkit-scrollbar-track { background: rgba(180, 155, 110, 0.2); }
.tab-content::-webkit-scrollbar-thumb { background: rgba(140, 107, 58, 0.5); border-radius: 3px; }

/* --- City Tab --- */
#city-info h3 {
    color: var(--parchment-header); font-family: var(--font-title);
    font-size: 18px; margin-bottom: 14px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--parchment-border);
    font-weight: bold;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.5);
}
#city-details .detail-row {
    display: flex; justify-content: space-between;
    padding: 5px 0; font-size: 13px;
    border-bottom: 1px solid rgba(120, 85, 40, 0.2);
}
#city-details .detail-label { color: var(--text-dim); }
#city-details .detail-value { color: var(--parchment-header); font-weight: 700; }

.city-goods-section { margin-top: 18px; }
.city-goods-section h4 {
    color: var(--parchment-header); font-size: 12px;
    text-transform: uppercase; letter-spacing: 1.5px;
    margin-bottom: 8px; font-weight: 700;
    font-family: var(--font-title);
}
.city-good-row {
    display: flex; align-items: center; justify-content: space-between;
    padding: 5px 8px; margin-bottom: 2px;
    background: var(--parchment-card);
    border-radius: var(--radius-sm);
    font-size: 12px;
    transition: background var(--transition);
    border: 1px solid rgba(120, 85, 40, 0.15);
}
.city-good-row:hover { background: var(--parchment-card-hover); }
.city-good-row.good-deal { border-left: 3px solid var(--success); }
.city-good-row.bad-deal { border-left: 3px solid var(--danger); }
.city-good-name { flex: 1; color: var(--parchment-text); }
.city-good-price { color: var(--gold-color); width: 60px; text-align: right; font-weight: 700; }
.city-good-stock { color: var(--text-dim); width: 50px; text-align: right; }
.city-good-trend { width: 20px; text-align: center; font-size: 10px; }
.trend-up { color: var(--danger); }
.trend-down { color: var(--success); }
.trend-stable { color: var(--text-dim); }

/* --- Trade Tab --- */
#trade-panel h3 {
    color: var(--parchment-header); margin-bottom: 14px;
    font-family: var(--font-title); font-weight: bold;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.5);
}
.trade-row {
    display: flex; align-items: center;
    padding: 8px 10px; margin-bottom: 4px;
    background: var(--parchment-card);
    border: 1px solid rgba(120, 85, 40, 0.15);
    border-radius: var(--radius);
    transition: all var(--transition);
    flex-wrap: wrap;
}
.trade-row:hover { background: var(--parchment-card-hover); }
.trade-good-info { flex: 1; }
.trade-good-name { font-size: 13px; font-weight: 700; color: var(--parchment-header); }
.trade-good-detail { font-size: 11px; color: var(--text-dim); margin-top: 1px; }
.trade-actions { display: flex; gap: 3px; align-items: center; flex-wrap: wrap; }
.trade-qty {
    width: 48px; padding: 4px 6px; text-align: center;
    background: rgba(255, 250, 235, 0.6);
    color: var(--parchment-text);
    border: 1px solid var(--parchment-border); border-radius: var(--radius-sm);
    font-size: 12px; font-weight: 600;
    transition: border-color var(--transition);
}
.trade-qty:focus { border-color: #8b6914; outline: none; }
.trade-btn {
    padding: 4px 10px; font-size: 12px; font-weight: 700;
    border: 2px solid; border-radius: var(--radius-sm);
    cursor: pointer; transition: all var(--transition);
    min-width: 28px; text-align: center;
}
.trade-btn.buy {
    background: rgba(42, 122, 72, 0.15);
    color: var(--success); border-color: rgba(42, 122, 72, 0.4);
}
.trade-btn.buy:hover { background: rgba(42, 122, 72, 0.3); border-color: var(--success); }
.trade-btn.sell {
    background: rgba(139, 32, 32, 0.15);
    color: var(--danger); border-color: rgba(139, 32, 32, 0.4);
}
.trade-btn.sell:hover { background: rgba(139, 32, 32, 0.3); border-color: var(--danger); }
.trade-btn:disabled { opacity: 0.25; cursor: not-allowed; }
.trade-btn-max {
    padding: 4px 6px; font-size: 10px;
    background: transparent; color: var(--text-dim);
    border: 1px solid var(--parchment-border); border-radius: var(--radius-sm);
    cursor: pointer; transition: all var(--transition);
}
.trade-btn-max:hover { color: #8b6914; border-color: rgba(139, 105, 20, 0.4); }
.trade-btn-max:disabled { opacity: 0.25; cursor: not-allowed; }

/* Trade Ship Selector */
.trade-ship-selector { display: flex; gap: 4px; margin-bottom: 8px; }
.trade-ship-btn {
    flex: 1; padding: 4px 6px; font-size: 11px;
    border-radius: 3px; cursor: pointer;
    background: var(--parchment-card);
    color: var(--text-dim);
    border: 1px solid var(--parchment-border);
    transition: all var(--transition);
    font-family: var(--font-main);
}
.trade-ship-btn.active {
    background: rgba(139, 105, 20, 0.25);
    color: var(--parchment-header);
    border-color: rgba(139, 105, 20, 0.5);
    font-weight: 700;
}
.trade-ship-btn:hover:not(.active) { background: var(--parchment-card-hover); }

/* Trade Advisor */
.trade-advisor {
    margin-bottom: 12px; padding: 8px 10px;
    background: linear-gradient(135deg, rgba(42, 122, 72, 0.1), rgba(139, 105, 20, 0.1));
    border: 1px solid rgba(42, 122, 72, 0.3);
    border-radius: var(--radius);
    border-left: 3px solid var(--success);
}
.trade-advisor-title {
    font-size: 11px; font-weight: 700;
    color: var(--parchment-header);
    text-transform: uppercase; letter-spacing: 1px;
    margin-bottom: 6px;
    font-family: var(--font-title);
}
.trade-advisor-tip {
    display: flex; align-items: center; gap: 6px;
    padding: 4px 6px; margin-bottom: 2px;
    border-radius: var(--radius-sm);
    font-size: 11px; cursor: pointer;
    transition: background var(--transition);
}
.trade-advisor-tip:hover { background: rgba(42, 122, 72, 0.12); }
.advisor-good { font-weight: 700; color: var(--parchment-text); min-width: 80px; }
.advisor-route { color: var(--text-dim); flex: 1; }
.advisor-profit { font-weight: 700; color: var(--success); min-width: 40px; text-align: right; }

/* Trade Controls (Filter + Sort) */
.trade-controls { margin-bottom: 10px; }
.trade-filter-row {
    display: flex; gap: 3px; margin-bottom: 6px; flex-wrap: wrap;
}
.trade-filter-btn {
    padding: 3px 8px; font-size: 10px; font-weight: 600;
    background: var(--parchment-card);
    color: var(--text-dim);
    border: 1px solid var(--parchment-border);
    border-radius: 10px; cursor: pointer;
    transition: all var(--transition);
    font-family: var(--font-main);
}
.trade-filter-btn.active {
    background: rgba(139, 105, 20, 0.2);
    color: #8b6914;
    border-color: rgba(139, 105, 20, 0.5);
}
.trade-filter-btn:hover:not(.active) { background: var(--parchment-card-hover); }
.trade-sort-row {
    display: flex; gap: 8px; align-items: center;
}
.trade-sort-select {
    flex: 1; padding: 3px 6px; font-size: 11px;
    background: rgba(255, 250, 235, 0.5);
    color: var(--parchment-text);
    border: 1px solid var(--parchment-border);
    border-radius: var(--radius-sm);
    font-family: var(--font-main);
    cursor: pointer;
}
.trade-sort-select:focus { outline: none; border-color: #8b6914; }
.trade-profit-toggle {
    display: flex; align-items: center; gap: 4px;
    font-size: 10px; color: var(--text-dim);
    cursor: pointer; white-space: nowrap;
}
.trade-profit-toggle input { cursor: pointer; accent-color: #8b6914; }

/* Trade Profit Badge (inside each trade row) */
.trade-profit-badge {
    display: flex; align-items: center; gap: 4px;
    margin-top: 3px; font-size: 10px;
}
.profit-dest {
    color: var(--text-dim); font-size: 9px;
}

/* Hot trade row (high profit) */
.trade-row-hot {
    border-left: 3px solid var(--success);
    background: rgba(42, 122, 72, 0.08);
}

.trade-summary {
    margin-bottom: 14px; padding: 10px 12px;
    background: linear-gradient(135deg, rgba(180, 155, 110, 0.4), rgba(160, 135, 90, 0.3));
    border: 1px solid var(--parchment-border);
    border-radius: var(--radius);
    font-size: 12px;
    position: relative;
    overflow: hidden;
}
.trade-summary::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, rgba(139, 105, 20, 0.5), transparent);
}
.trade-summary-row {
    display: flex; justify-content: space-between;
    padding: 3px 0;
}

/* --- Fleet Tab --- */
#fleet-panel h3, #fleet-panel h4 {
    color: var(--parchment-header); margin-bottom: 12px;
    font-family: var(--font-title); font-weight: bold;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.5);
}
.ship-card {
    padding: 12px; margin-bottom: 8px;
    background: var(--parchment-card);
    border-radius: var(--radius);
    border: 1px solid rgba(120, 85, 40, 0.2);
    cursor: pointer;
    transition: all var(--transition);
}
.ship-card:hover {
    border-color: rgba(120, 85, 40, 0.4);
    background: var(--parchment-card-hover);
}
.ship-card.selected {
    border-color: rgba(139, 105, 20, 0.6);
    background: rgba(180, 155, 110, 0.4);
}
.ship-card-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px;
}
.ship-card-name { font-weight: 700; color: var(--parchment-header); font-size: 14px; }
.ship-card-type { font-size: 11px; color: var(--text-dim); }
.ship-card-stats {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 4px; font-size: 11px;
}
.ship-stat { display: flex; justify-content: space-between; }
.ship-stat-label { color: var(--text-dim); }
.ship-stat-value { color: var(--parchment-text); font-weight: 700; }
.ship-cargo-bar {
    margin-top: 8px; height: 5px;
    background: rgba(120, 85, 40, 0.2);
    border-radius: 3px; overflow: hidden;
}
.ship-cargo-fill {
    height: 100%;
    background: linear-gradient(90deg, #8b6914, #b8860b);
    border-radius: 3px; transition: width 0.4s ease;
}
.ship-status {
    margin-top: 6px; font-size: 11px;
    padding: 2px 8px; border-radius: 10px;
    display: inline-block; font-weight: 700;
}
.ship-status.docked { background: rgba(42, 122, 72, 0.15); color: var(--success); }
.ship-status.sailing { background: rgba(42, 106, 154, 0.15); color: var(--info); }
.ship-status.trading { background: rgba(139, 105, 20, 0.15); color: #8b6914; }

/* Shipyard */
.shipyard-item {
    padding: 12px; margin-bottom: 6px;
    background: var(--parchment-card);
    border-radius: var(--radius);
    border: 1px solid var(--parchment-border);
    transition: all var(--transition);
}
.shipyard-item:hover { background: var(--parchment-card-hover); border-color: rgba(120, 85, 40, 0.7); }
.shipyard-item-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 4px;
}
.shipyard-item-name { font-weight: 600; color: var(--parchment-header); font-size: 13px; }
.shipyard-item-cost { color: #8b6914; font-size: 13px; font-weight: 600; }
.shipyard-item-stats { font-size: 11px; color: #6b5a48; margin-bottom: 8px; }
.shipyard-buy-btn {
    padding: 5px 14px; font-size: 12px; font-weight: 600;
    background: linear-gradient(135deg, #7a5a1a, #a88020);
    color: #f5eed8;
    border: 1px solid rgba(120, 85, 40, 0.5);
    border-radius: var(--radius-sm);
    cursor: pointer; transition: all var(--transition);
    text-shadow: 0 1px 1px rgba(0,0,0,0.3);
}
.shipyard-buy-btn:hover { filter: brightness(1.15); transform: translateY(-1px); }
.shipyard-buy-btn:disabled { opacity: 0.25; cursor: not-allowed; filter: none; transform: none; }

/* --- Build Tab --- */
#build-panel h3 {
    color: var(--parchment-header); margin-bottom: 12px;
    font-family: var(--font-title); font-weight: normal;
    text-shadow: 1px 1px 0 rgba(232, 213, 176, 0.6);
}
.build-item {
    padding: 12px; margin-bottom: 6px;
    background: var(--parchment-card);
    border-radius: var(--radius);
    border: 1px solid var(--parchment-border);
    transition: all var(--transition);
}
.build-item:hover { background: var(--parchment-card-hover); border-color: rgba(120, 85, 40, 0.7); }
.build-item-header { display: flex; justify-content: space-between; margin-bottom: 4px; }
.build-item-name { font-weight: 600; color: var(--parchment-header); font-size: 13px; }
.build-item-cost { color: #8b6914; font-size: 12px; font-weight: 600; }
.build-item-desc { font-size: 11px; color: #6b5a48; margin-bottom: 6px; line-height: 1.4; }
.build-item-owned { font-size: 11px; color: #6b5a48; margin-bottom: 6px; }
.build-buy-btn {
    padding: 5px 14px; font-size: 12px; font-weight: 600;
    background: linear-gradient(135deg, #7a5a1a, #a88020);
    color: #f5eed8;
    border: 1px solid rgba(120, 85, 40, 0.5);
    border-radius: var(--radius-sm);
    cursor: pointer; transition: all var(--transition);
    text-shadow: 0 1px 1px rgba(0,0,0,0.3);
}
.build-buy-btn:hover { filter: brightness(1.15); transform: translateY(-1px); }
.build-buy-btn:disabled { opacity: 0.25; cursor: not-allowed; filter: none; transform: none; }

/* Production Chain Display */
.production-chain {
    margin: 4px 0 6px;
    padding: 5px 8px;
    background: rgba(90, 70, 30, 0.15);
    border: 1px dashed rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    font-size: 11px;
}
.chain-flow {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
    line-height: 1.6;
}
.chain-resource {
    padding: 1px 5px;
    border-radius: 3px;
    background: rgba(90, 70, 30, 0.2);
    white-space: nowrap;
}
.chain-ok { color: var(--success); }
.chain-missing { color: var(--danger); }
.chain-output { color: var(--accent); font-weight: 600; }
.chain-stock { font-size: 9px; opacity: 0.7; }
.chain-arrow { font-size: 14px; color: var(--accent); font-weight: bold; margin: 0 2px; }
.prod-status {
    font-size: 10px;
    font-weight: 600;
    padding: 1px 6px;
    border-radius: 8px;
    white-space: nowrap;
}
.prod-active { color: var(--success); background: rgba(46, 172, 104, 0.15); }
.prod-idle { color: var(--danger); background: rgba(217, 64, 64, 0.15); }

/* === DIPLOMACY / REPUTATION === */
.rep-display {
    background: rgba(90, 70, 30, 0.15);
    border: 1px solid rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    padding: 8px 10px;
    margin: 6px 0;
}
.rep-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.rep-label { font-size: 11px; color: var(--parchment-dim); }
.rep-value { font-size: 12px; font-weight: 600; }
.rep-progress-bar {
    height: 4px;
    background: rgba(120, 85, 40, 0.2);
    border-radius: 2px;
    margin: 4px 0;
    overflow: hidden;
}
.rep-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #e8a020, #ffd700);
    border-radius: 2px;
    transition: width 0.3s ease;
}
.rep-next { font-size: 9px; color: var(--parchment-dim); }
.rep-bonus { font-size: 10px; color: var(--success); display: block; margin-top: 2px; }
.diplo-section { margin: 10px 0; }
.diplo-section h4 {
    font-size: 11px;
    text-transform: uppercase;
    color: var(--parchment-dim);
    margin-bottom: 6px;
    letter-spacing: 0.5px;
}
.diplo-action {
    background: var(--parchment-card);
    border: 1px solid rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    padding: 8px;
    margin-bottom: 6px;
    transition: all var(--transition);
}
.diplo-action:hover { background: var(--parchment-card-hover); }
.diplo-unavailable { opacity: 0.5; }
.diplo-action-header { display: flex; justify-content: space-between; font-size: 12px; font-weight: 600; margin-bottom: 2px; }
.diplo-cost { color: #8b6914; }
.diplo-desc { font-size: 10px; color: var(--parchment-dim); margin-bottom: 4px; }
.diplo-btn {
    padding: 3px 10px;
    font-size: 11px;
    font-weight: 600;
    background: linear-gradient(135deg, #3a5a7a, #4a7aaa);
    color: #f5eed8;
    border: 1px solid rgba(60, 100, 140, 0.5);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition);
}
.diplo-btn:hover { filter: brightness(1.15); transform: translateY(-1px); }
.diplo-blocked { font-size: 10px; color: var(--danger); font-style: italic; }

/* === QUEST BOARD === */
.quest-board {
    padding: 16px;
    max-width: 450px;
    max-height: 80vh;
    overflow-y: auto;
}
.quest-board-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.quest-board-header h3 { margin: 0; }
.modal-close-btn {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: var(--parchment-text);
    padding: 0 4px;
}
.quest-stats {
    display: flex;
    gap: 12px;
    font-size: 11px;
    color: var(--parchment-dim);
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(120, 85, 40, 0.3);
}
.quest-section-title {
    font-size: 11px;
    text-transform: uppercase;
    color: var(--parchment-dim);
    margin: 12px 0 6px;
    letter-spacing: 0.5px;
}
.quest-card {
    background: var(--parchment-card);
    border: 1px solid rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    padding: 10px;
    margin-bottom: 8px;
    transition: all var(--transition);
}
.quest-card:hover { background: var(--parchment-card-hover); }
.quest-urgent { border-color: var(--danger); background: rgba(217, 64, 64, 0.08); }
.quest-offer { border-left: 3px solid var(--accent); }
.quest-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 4px;
}
.quest-title { font-weight: 600; font-size: 12px; color: var(--parchment-header); }
.quest-timer { font-size: 11px; font-weight: 600; color: var(--warning); }
.quest-reward { font-size: 11px; font-weight: 600; color: var(--gold-color); }
.quest-desc { font-size: 11px; color: var(--parchment-dim); margin-bottom: 6px; line-height: 1.4; }
.quest-meta { font-size: 10px; color: var(--parchment-dim); margin-bottom: 6px; }
.quest-progress-bar {
    height: 4px;
    background: rgba(120, 85, 40, 0.2);
    border-radius: 2px;
    margin: 4px 0;
    overflow: hidden;
}
.quest-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), #ffd700);
    border-radius: 2px;
    transition: width 0.3s ease;
}
.quest-progress-text { font-size: 10px; color: var(--parchment-dim); }
.quest-btn {
    padding: 4px 12px;
    font-size: 11px;
    font-weight: 600;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition);
    border: 1px solid rgba(120, 85, 40, 0.4);
}
.quest-btn:hover { filter: brightness(1.15); transform: translateY(-1px); }
.quest-btn-accept {
    background: linear-gradient(135deg, #1a6a2a, #28a840);
    color: #f5eed8;
    border-color: rgba(40, 140, 60, 0.5);
}
.quest-btn-abandon {
    background: rgba(160, 60, 60, 0.3);
    color: #d4a0a0;
    border-color: rgba(160, 60, 60, 0.4);
    font-size: 10px;
    padding: 3px 8px;
}

/* === BANK TAB === */
.bank-overview {
    background: rgba(90, 70, 30, 0.15);
    border: 1px solid rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    padding: 10px;
    margin-bottom: 12px;
}
.bank-stat {
    display: flex;
    justify-content: space-between;
    padding: 3px 0;
    font-size: 12px;
}
.bank-label { color: var(--parchment-text); }
.bank-value { font-weight: 600; }
.bank-section-title {
    font-size: 11px;
    text-transform: uppercase;
    color: var(--parchment-dim);
    margin: 12px 0 6px;
    letter-spacing: 0.5px;
}
.loan-card, .loan-offer {
    background: var(--parchment-card);
    border: 1px solid rgba(120, 85, 40, 0.3);
    border-radius: var(--radius-sm);
    padding: 10px;
    margin-bottom: 8px;
    transition: all var(--transition);
}
.loan-card:hover, .loan-offer:hover { background: var(--parchment-card-hover); }
.loan-urgent { border-color: var(--danger); background: rgba(217, 64, 64, 0.08); }
.loan-unavailable { opacity: 0.5; }
.loan-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 4px;
}
.loan-name { font-weight: 600; color: var(--parchment-header); font-size: 13px; }
.loan-remaining { font-weight: 600; color: var(--danger); font-size: 12px; }
.loan-desc { font-size: 11px; color: var(--parchment-dim); margin-bottom: 4px; }
.loan-details {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: var(--parchment-dim);
    margin-bottom: 6px;
}
.loan-progress-bar {
    height: 4px;
    background: rgba(120, 85, 40, 0.2);
    border-radius: 2px;
    margin-bottom: 8px;
    overflow: hidden;
}
.loan-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success), #27ae60);
    border-radius: 2px;
    transition: width 0.3s ease;
}
.loan-actions {
    display: flex;
    gap: 6px;
}
.bank-btn {
    padding: 4px 10px;
    font-size: 11px;
    font-weight: 600;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition);
    border: 1px solid rgba(120, 85, 40, 0.4);
    background: rgba(90, 70, 30, 0.2);
    color: var(--parchment-text);
}
.bank-btn:hover { filter: brightness(1.15); transform: translateY(-1px); }
.bank-btn-take {
    background: linear-gradient(135deg, #7a5a1a, #a88020);
    color: #f5eed8;
    text-shadow: 0 1px 1px rgba(0,0,0,0.3);
}
.bank-btn-repay {
    background: linear-gradient(135deg, #1a5a2a, #20a840);
    color: #f5eed8;
}
.bank-btn-partial { background: rgba(90, 70, 30, 0.3); }
.loan-take-controls {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-top: 6px;
}
.loan-slider {
    width: 100%;
    accent-color: var(--accent);
    height: 6px;
}
.loan-amount-display {
    text-align: center;
    font-weight: 600;
    font-size: 13px;
    color: var(--accent);
}
.loan-blocked {
    font-size: 10px;
    color: var(--danger);
    font-style: italic;
    margin-top: 4px;
}

/* === BOTTOM BAR === */
#bottom-bar {
    height: 72px; flex-shrink: 0;
    background: linear-gradient(0deg, rgba(10, 14, 24, 0.98), rgba(14, 22, 38, 0.95));
    border-top: 1px solid var(--border);
    overflow-y: auto; padding: 6px 14px;
}
#message-log { font-size: 12px; }
.log-entry {
    padding: 3px 0;
    border-bottom: 1px solid rgba(60, 80, 120, 0.1);
    display: flex; gap: 8px;
    animation: logFadeIn 0.3s ease;
}
@keyframes logFadeIn {
    from { opacity: 0; transform: translateY(4px); }
    to { opacity: 1; transform: translateY(0); }
}
.log-time { color: var(--text-dim); font-size: 11px; white-space: nowrap; opacity: 0.6; }
.log-text { color: var(--text); opacity: 0.85; }
.log-text.event { color: var(--warning); }
.log-text.trade { color: var(--success); }
.log-text.danger { color: var(--danger); }
.log-text.info { color: var(--info); }

/* === MODAL === */
#modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex; justify-content: center; align-items: center;
    z-index: 1000;
    backdrop-filter: blur(4px);
    animation: overlayIn 0.2s ease;
}
@keyframes overlayIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
#modal-overlay.hidden { display: none; }
#modal-content {
    background: var(--bg-panel);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    padding: 28px; min-width: 380px; max-width: 600px;
    max-height: 80vh; overflow-y: auto;
    box-shadow: var(--shadow-lg);
    backdrop-filter: blur(12px);
    animation: modalIn 0.3s ease-out;
}
#modal-content h3 {
    color: var(--accent); font-family: var(--font-title);
    margin-bottom: 18px; text-align: center;
    font-weight: normal; font-size: 20px;
}
#modal-content p { margin-bottom: 10px; line-height: 1.6; }
.modal-buttons {
    display: flex; gap: 10px; margin-top: 20px; justify-content: center;
}
.modal-btn {
    padding: 10px 24px; font-size: 14px;
    border-radius: var(--radius); cursor: pointer;
    transition: all 0.25s ease; border: 1px solid;
    font-family: var(--font-main); font-weight: 600;
}
.modal-btn.primary {
    background: linear-gradient(135deg, var(--accent-dark), var(--accent));
    color: #fff; border-color: var(--accent);
}
.modal-btn.primary:hover {
    filter: brightness(1.15);
    box-shadow: 0 4px 16px rgba(230, 168, 23, 0.2);
}
.modal-btn.secondary {
    background: rgba(20, 36, 64, 0.6);
    color: var(--text); border-color: var(--border);
}
.modal-btn.secondary:hover { background: rgba(30, 50, 80, 0.8); }
.modal-btn.danger {
    background: rgba(217, 64, 64, 0.15);
    color: var(--danger); border-color: rgba(217, 64, 64, 0.3);
}
.modal-btn.danger:hover { background: rgba(217, 64, 64, 0.3); }

/* === NOTIFICATIONS === */
#notification-area {
    position: fixed; top: 54px; right: 16px;
    z-index: 900; display: flex;
    flex-direction: column; gap: 8px;
    pointer-events: none;
}
.notification {
    padding: 12px 18px;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    font-size: 13px;
    box-shadow: var(--shadow-md);
    backdrop-filter: blur(12px);
    animation: notifSlide 0.35s cubic-bezier(0.16, 1, 0.3, 1);
    pointer-events: auto;
    max-width: 340px;
    border-left: 3px solid var(--border);
}
.notification.success { border-left-color: var(--success); }
.notification.warning { border-left-color: var(--warning); }
.notification.danger { border-left-color: var(--danger); }
.notification.info { border-left-color: var(--info); }

@keyframes notifSlide {
    from { transform: translateX(120%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}
@keyframes notifFade {
    to { opacity: 0; transform: translateX(40px); }
}

/* === PROGRESS BARS === */
.progress-bar {
    height: 6px; background: rgba(20, 36, 64, 0.8);
    border-radius: 3px; overflow: hidden; margin: 4px 0;
}
.progress-fill {
    height: 100%; border-radius: 3px;
    transition: width 0.4s ease;
}
.progress-fill.green { background: linear-gradient(90deg, #1a8a4a, var(--success)); }
.progress-fill.gold { background: linear-gradient(90deg, var(--accent-dark), var(--accent)); }
.progress-fill.blue { background: linear-gradient(90deg, #1a5a9a, var(--info)); }
.progress-fill.red { background: linear-gradient(90deg, #8a2020, var(--danger)); }

/* === EVENT POPUP === */
.event-popup { text-align: center; }
.event-popup .event-icon { font-size: 52px; margin-bottom: 14px; }
.event-popup .event-text { font-size: 14px; line-height: 1.7; margin-bottom: 10px; }
.event-popup .event-effect { font-size: 13px; color: var(--warning); font-style: italic; }

/* === AUTO-TRADE ROUTES === */
.route-item {
    padding: 10px; margin-bottom: 4px;
    background: var(--bg-card);
    border-radius: var(--radius);
    font-size: 12px;
    display: flex; justify-content: space-between; align-items: center;
    transition: background var(--transition);
}
.route-item:hover { background: var(--bg-card-hover); }
.route-item .route-info { flex: 1; }
.route-delete {
    padding: 3px 10px;
    background: rgba(217, 64, 64, 0.1);
    color: var(--danger);
    border: 1px solid rgba(217, 64, 64, 0.25);
    border-radius: var(--radius-sm);
    cursor: pointer; font-size: 11px;
    transition: all var(--transition);
}
.route-delete:hover { background: rgba(217, 64, 64, 0.25); }

/* === REPUTATION BAR === */
.rep-bar-container { margin-top: 8px; }
.rep-bar-label { font-size: 11px; color: var(--text-dim); margin-bottom: 3px; }

/* === PRICE CHART === */
#price-chart-container canvas {
    border: 1px solid var(--border);
    border-radius: var(--radius);
}

/* === MOBILE TOGGLE BUTTON === */
#mobile-panel-toggle {
    display: none;
    position: fixed; bottom: 80px; right: 12px;
    z-index: 50;
    width: 48px; height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent-dark), var(--accent));
    color: #fff; font-size: 20px;
    border: 2px solid rgba(255,255,255,0.15);
    box-shadow: 0 4px 16px rgba(0,0,0,0.5), 0 0 12px rgba(230,168,23,0.2);
    cursor: pointer;
    transition: all 0.25s ease;
    align-items: center; justify-content: center;
}
#mobile-panel-toggle:active { transform: scale(0.92); }

/* Mobile panel close */
#mobile-panel-close {
    display: none;
    position: absolute; top: 6px; right: 10px;
    background: none; border: none;
    color: var(--text-dim); font-size: 22px;
    cursor: pointer; z-index: 2;
    padding: 4px 8px;
}
#mobile-panel-close:hover { color: var(--text-light); }

/* === RESPONSIVE === */
@media (max-width: 1100px) {
    #side-panel { width: 300px; }
    .trade-actions { font-size: 10px; }
    .trade-btn { padding: 3px 7px; font-size: 10px; }
}

@media (max-width: 900px) {
    #side-panel { width: 260px; }
    .game-title { font-size: 52px; letter-spacing: 10px; }
    .game-subtitle { font-size: 14px; letter-spacing: 3px; }
    .title-ship-left, .title-ship-right { display: none; }
    .title-btn { width: 220px; padding: 12px 24px; font-size: 15px; }
    .setup-container { min-width: 340px; padding: 28px 32px; }
}

/* === MOBILE LAYOUT (< 768px) === */
@media (max-width: 768px) {
    html, body { font-size: 13px; }

    /* Title screen */
    .game-title { font-size: 40px; letter-spacing: 6px; }
    .game-subtitle { font-size: 12px; letter-spacing: 2px; }
    .title-ship-left, .title-ship-right { display: none; }
    .title-btn { width: 200px; padding: 14px 20px; font-size: 15px; }
    .title-container { gap: 16px; }
    .title-credit { font-size: 10px; margin-top: 24px; }
    .title-ornament { width: 160px; margin: 14px auto 24px; }

    /* Setup screen */
    .setup-container { min-width: 0; width: 92vw; max-width: 400px; padding: 24px 20px; }
    .setup-container h2 { font-size: 20px; }

    /* Help screen */
    .help-container { max-width: 92vw; padding: 20px; max-height: 88vh; }

    /* Top bar — compact */
    #top-bar { height: 40px; padding: 0 8px; gap: 4px; }
    .top-bar-left { gap: 6px; }
    .top-bar-center { gap: 6px; }
    .top-bar-right { gap: 4px; }
    .top-info { font-size: 11px; }
    #player-display { display: none; }
    .speed-btn { padding: 3px 7px; font-size: 10px; }
    .top-btn { padding: 4px 6px; font-size: 14px; }

    /* Main content — full width map */
    #main-content { flex-direction: column; position: relative; }
    #map-panel { flex: 1; width: 100%; }

    /* Side panel — overlay on mobile */
    #side-panel {
        position: fixed;
        top: 40px; left: 0; right: 0; bottom: 0;
        width: 100% !important;
        z-index: 40;
        transform: translateY(100%);
        transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        border-left: none;
        border-top: 2px solid var(--accent-dark);
        border-radius: 16px 16px 0 0;
        overflow-y: auto;
    }
    #side-panel.mobile-open {
        transform: translateY(0);
    }

    /* Show toggle + close buttons */
    #mobile-panel-toggle { display: flex; }
    #side-panel.mobile-open ~ #mobile-panel-toggle { display: none; }
    #mobile-panel-close { display: block; }

    /* Tabs — bigger touch targets */
    .tab-btn { padding: 12px 6px 10px; font-size: 12px; }
    .tab-content { padding: 12px; }

    /* Trade — stack better */
    .trade-row { padding: 10px; flex-wrap: wrap; gap: 6px; }
    .trade-actions { width: 100%; justify-content: flex-end; margin-top: 4px; }
    .trade-btn { padding: 8px 14px; font-size: 13px; min-width: 44px; }
    .trade-qty { width: 56px; padding: 8px; font-size: 14px; }
    .trade-btn-max { padding: 6px 10px; font-size: 12px; }

    /* Fleet — touch friendly */
    .ship-card { padding: 14px; }
    .shipyard-buy-btn { padding: 10px 18px; font-size: 14px; }
    .build-buy-btn { padding: 10px 18px; font-size: 14px; }

    /* Bottom bar — smaller */
    #bottom-bar { height: 52px; padding: 4px 10px; }
    #message-log { font-size: 11px; }

    /* Modal — full width */
    #modal-content {
        min-width: 0; width: 94vw; max-width: 500px;
        padding: 20px; max-height: 88vh;
    }
    .modal-buttons { flex-wrap: wrap; }
    .modal-btn { padding: 12px 16px; font-size: 14px; flex: 1; min-width: 100px; }

    /* Notifications */
    #notification-area { top: 44px; right: 8px; left: 8px; }
    .notification { max-width: 100%; font-size: 12px; padding: 10px 14px; }

    /* Wind indicator */
    #wind-indicator { bottom: 58px; left: 8px; padding: 4px 8px; font-size: 11px; }

    /* Tooltip — wider on mobile */
    .tooltip { max-width: 200px; font-size: 11px; }
}

/* === SMALL PHONES (< 480px) === */
@media (max-width: 480px) {
    .game-title { font-size: 32px; letter-spacing: 4px; }
    .game-subtitle { font-size: 11px; }
    .title-btn { width: 180px; padding: 12px 16px; font-size: 14px; }

    #top-bar { height: 36px; }
    #rank-display { display: none; }
    .speed-controls { gap: 1px; }
    .speed-btn { padding: 2px 5px; font-size: 9px; }

    .tab-btn { padding: 10px 2px; font-size: 10px; letter-spacing: 0.3px; }

    #modal-content { padding: 16px; }
    .modal-btn { font-size: 13px; padding: 10px 12px; }
}

@media (max-height: 700px) {
    #modal-content { max-height: 90vh; }
    #bottom-bar { height: 56px; }
}

/* ============================================
   COMBAT SYSTEM UI
   ============================================ */
.combat-ui {
    min-width: 420px; max-width: 560px;
    text-align: center;
}
.combat-ui h3 {
    font-size: 22px !important;
    color: var(--danger) !important;
    text-shadow: 0 0 20px rgba(217, 64, 64, 0.3);
    margin-bottom: 20px !important;
}

/* Ship comparison layout */
.combat-ships {
    display: flex;
    align-items: stretch;
    gap: 12px;
    margin-bottom: 18px;
}
.combat-ship {
    flex: 1;
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 14px;
    border: 1px solid var(--border);
    text-align: center;
}
.combat-ship.player-ship {
    border-color: rgba(230, 168, 23, 0.25);
    background: rgba(230, 168, 23, 0.04);
}
.combat-ship.enemy-ship {
    border-color: rgba(217, 64, 64, 0.25);
    background: rgba(217, 64, 64, 0.04);
}
.combat-ship-name {
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 2px;
    font-family: var(--font-title);
}
.combat-ship-type {
    font-size: 11px;
    color: var(--text-dim);
    margin-bottom: 10px;
}

/* Hull bar */
.combat-bar {
    height: 10px;
    background: rgba(20, 36, 64, 0.8);
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 10px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.4);
}
.combat-bar-fill {
    height: 100%;
    border-radius: 5px;
    transition: width 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 0 8px currentColor;
}

/* Stats row */
.combat-stats {
    display: flex;
    justify-content: space-around;
    font-size: 11px;
    color: var(--text-dim);
    gap: 4px;
}
.combat-stats span {
    white-space: nowrap;
}

/* VS divider */
.combat-vs {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    min-width: 44px;
    filter: drop-shadow(0 0 8px rgba(255, 150, 50, 0.3));
    animation: combatPulse 1.5s ease-in-out infinite;
}
@keyframes combatPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
}

/* Combat log */
.combat-log {
    background: rgba(8, 14, 28, 0.7);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 10px 14px;
    margin-bottom: 18px;
    max-height: 140px;
    overflow-y: auto;
    text-align: left;
}
.combat-log-entry {
    font-size: 12px;
    line-height: 1.6;
    padding: 2px 0;
    border-bottom: 1px solid rgba(60, 80, 120, 0.08);
    animation: logFadeIn 0.3s ease;
}
.combat-log-entry:last-child {
    border-bottom: none;
    font-weight: 600;
}

/* Action buttons */
.combat-actions {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
}
.combat-actions .modal-btn {
    min-width: 130px;
    font-size: 15px;
    padding: 12px 20px;
}
.combat-actions .modal-btn.primary {
    animation: combatBtnGlow 2s ease-in-out infinite;
}
@keyframes combatBtnGlow {
    0%, 100% { box-shadow: 0 0 0 rgba(230, 168, 23, 0); }
    50% { box-shadow: 0 0 18px rgba(230, 168, 23, 0.25); }
}

/* Result banner */
.combat-result {
    font-size: 24px;
    font-family: var(--font-title);
    font-weight: 700;
    margin-bottom: 14px;
    padding: 10px;
    border-radius: var(--radius);
    background: var(--bg-card);
    border: 1px solid var(--border);
    animation: resultReveal 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}
@keyframes resultReveal {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

/* Responsive combat */
@media (max-width: 600px) {
    .combat-ui { min-width: 280px; }
    .combat-ships { flex-direction: column; }
    .combat-vs {
        min-width: auto;
        padding: 4px 0;
        font-size: 22px;
    }
    .combat-actions .modal-btn { min-width: 100px; font-size: 13px; padding: 10px 16px; }
}
